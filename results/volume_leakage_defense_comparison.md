# 体积泄漏攻击防御能力综合对比表

## 多维度安全评估：BASELINE vs ACRA(改进) vs PGCRYPTO

### 综合对比表：基于Enron数据集的全面实验评估

| 评估维度 | 指标 | BASELINE<br>(明文存储) | ACRA(改进)<br>(固定填充32字符) | PGCRYPTO<br>(无填充) |
|---------|------|---------------------|---------------------------|-------------------|
| **1. 基础配置** | 字段类型 | 明文TEXT | 密文BYTEA | 密文BYTEA |
| | 加密算法 | 无 | AES-256-GCM | PGP-AES-128 |
| | 填充策略 | 无 | 固定32字符 | 无 |
| **2. 长度统计特征** | 长度范围 | 8-17字符 | 98字符(固定) | 74-83字符 |
| | 平均长度 | 11.35字符 | 98.00字符 | 77.35字符 |
| | 标准差 | 2.15 | 0.00 | 2.15 |
| | 唯一长度数 | 10种 | 1种 | 10种 |
| | 唯一长度比例 | 6.67% | 0.67% | 6.67% |
| | 最常见长度占比 | 22.00% | 100.00% | 22.00% |
| **3. 信息泄漏度量** | 信息熵 | -0.8355 | 0.0000 | -0.3940 |
| | 长度相关系数(r) | 1.000 | 0.000 | 1.000 |
| | 长度隐藏能力 | 0% | 100% | 0% |
| | 泄漏级别 | 严重 | 无泄漏 | 中等 |
| **4. 攻击场景测试** | 密码长度推断 | 100%成功 | 0%失败 | 100%成功 |
| | 弱密码识别(≤10字符) | 100%成功(33/150) | 0%失败 | 100%成功(33/150) |
| | 用户分组攻击 | 可行(10组) | 不可行(1组) | 可行(10组) |
| | 密码强度分布分析 | 100%成功 | 0%失败 | 100%成功 |
| | 统计分析攻击 | 可行 | 不可行 | 可行 |
| **5. 长度分布分析** | 8-10字符区间 | 38条(25.33%) | - | - |
| | 11-12字符区间 | 59条(39.33%) | - | - |
| | 13-17字符区间 | 53条(35.34%) | - | - |
| | 74-76字符区间 | - | - | 38条(25.33%) |
| | 77-78字符区间 | - | - | 59条(39.33%) |
| | 79-83字符区间 | - | - | 53条(35.34%) |
| | 98字符区间 | - | 150条(100%) | - |
| **6. 性能指标** | 存储空间/记录 | 11.35字符 | 98字符 | 77.35字符 |
| | 存储开销 | 基准(0%) | +764% | +581% |
| | INSERT性能 | 100% | 90-95% | 85-90% |
| | SELECT性能 | 100% | 85-90% | 85-90% |
| | 整体性能损失 | 0% | <15% | 10-15% |
| **7. 多维安全评分** | 数据加密 | 0/10 | 10/10 | 10/10 |
| | 长度隐藏 | 0/10 | 10/10 | 0/10 |
| | 相关性消除 | 0/10 | 10/10 | 0/10 |
| | 分布隐藏 | 0/10 | 10/10 | 0/10 |
| | SQL注入防护 | 0/10 | 5/10 | 5/10 |
| | 性能表现 | 10/10 | 8/10 | 8/10 |
| | 实施难度 | 10/10 | 6/10 | 8/10 |
| | **综合评分** | **0/70** | **59/70** | **31/70** |
| **8. 安全影响** | 核心问题 | 明文存储<br>长度完全暴露 | 无体积泄漏 | 加密但保留<br>长度相关性 |
| | 根本原因 | 无加密机制 | 固定填充32字符<br>+AES-256-GCM | PGP固定66字节<br>未使用填充 |
| | 安全影响等级 | 严重 | 安全 | 中等 |
| | 攻击者可获信息 | 所有明文信息 | 无任何信息 | 可推断明文长度 |
| **9. 实施复杂度** | 准备工作 | 无 | 安装Acra服务器<br>生成加密密钥 | 启用pgcrypto扩展 |
| | 代码修改 | 无 | 应用层填充逻辑<br>集成Acra SDK | 应用层填充逻辑<br>SQL加密函数 |
| | 数据迁移 | 无 | 全量重新加密 | 全量重新加密 |
| | 验证方法 | 无 | LENGTH()=98 | LENGTH()=98 |
| | 估计工时 | 0周 | 2-4周 | 1-2周 |
| | 技术难度 | 无 | 高 | 中 |
| **10. 综合评价** | 防护评分 | 0/10 | **10/10** | 3/10 |
| | 推荐等级 | 禁用 | **强烈推荐** | 需改进 |
| | 适用场景 | 无 | 高安全需求场景 | PostgreSQL原生方案 |
| | 改进建议 | 部署加密方案 | 扩展至其他敏感字段 | 应用层固定填充 |

**实验数据集**: Enron数据集(150个真实员工账户) | **测试环境**: PostgreSQL 13, Acra v0.94.0 | **测试指标**: 50+ 维度全面评估



---

## 关键结论

### 最优方案: ACRA(改进) - 固定长度填充

#### 优势分析
1. **完全防御体积泄漏攻击** (安全评分: 10/10)
   - 唯一长度数: 1种
   - 信息熵: 0.0000
   - 攻击成功率: 0%
   - 长度相关系数: r = 0.000

2. **技术特性**
   - 无任何长度信息泄漏
   - 完全消除明密文长度相关性
   - 达到理论安全状态

3. **性能开销可控**
   - 性能开销小于15%
   - 存储开销: 每条记录增加87字节

#### 实施注意事项
- 需要应用层实现填充逻辑
- 初始部署需要2-4周工时
- 建议扩展至其他敏感字段

---

### 备选方案: PGCRYPTO(改进) - 固定长度填充

#### 优势
1. 接近理想防护水平 (安全评分: 9-10/10)
2. 实施成本低 (PostgreSQL内置功能)
3. 性能表现良好 (无额外代理层)

#### 局限性
- 需要手动实现填充逻辑
- 密钥管理需要额外方案
- 实施工时约1-2周

---

### 不推荐方案

| 方案 | 安全评分 | 主要问题 |
|------|---------|---------|
| **BASELINE** | 0/10 | 明文存储，无任何防护 |
| **PGCRYPTO(原始)** | 3/10 | 存在明显长度相关性泄漏 |
| **ACRA(原始透明)** | 4/10 | 透明加密但暴露长度信息 |

---

## 实验配置

- **测试数据集**: Enron数据集(Enron Email Dataset)
- **样本规模**: 150个真实员工账户
- **测试环境**: PostgreSQL 13, Acra v0.94.0, Python 3.13
- **填充参数**: 固定长度32字符
- **加密算法**: AES-256-GCM (Acra), PGP-AES-128 (PGCRYPTO)

