%YAML 1.1
---
vars:
  address-groups:
    HOME_NET: "[10.0.0.0/8,172.16.0.0/12,192.168.0.0/16]"
  port-groups:
    HTTP_PORTS: "80,8080,8081"
    SQL_PORTS: "5432,5433"

default-log-dir: /var/log/suricata

logging:
  default-log-level: info
  outputs:
    - eve-log:
        enabled: yes
        filetype: regular
        filename: eve.json
        types:
          - alert
          - http
          - dns
          - tls
          - flow
          - stats
    - fast-log:
        enabled: yes
        filename: fast.log

rule-files:
  - sql-injection.rules

outputs:
  - stats:
      enabled: yes
      filename: stats.log
      interval: 60

# Minimal detection engine tuning
engine-analysis:
  rules-fast-pattern: yes

app-layer:
  protocols:
    http:
      enabled: yes
      libhtp:
        default-config:
          personality: IDS
          request-body-limit: 100kb
          response-body-limit: 100kb
          request-body-minimal-inspect-size: 32kb
          response-body-minimal-inspect-size: 32kb
          request-body-inject: no
          response-body-decompress-layer-limit: 2

# Disable checksum verification in container env
checksums:
  check-all: no
